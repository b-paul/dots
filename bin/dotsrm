#! /usr/bin/env bash

set -e

SOURCE=$BASH_SOURCE
while [ -h $SOURCE ]; do
  NEW_SOURCE="$(readlink $SOURCE)"
  [[ $NEW_SOURCE != /* ]] && NEW_SOURCE="$(dirname $SOURCE)/$NEW_SOURCE"
  SOURCE=$NEW_SOURCE
done

cd "$(dirname $SOURCE)"
cd "$(git rev-parse --show-toplevel)"

for file in $@; do
  targetloc="$HOME/$file"
  sourceloc="$PWD/$file"
  if [ -h $targetloc ]; then
    unlink "$targetloc"
    mv "$sourceloc" "$targetloc"
  fi
  if [ ! -h $targetloc ]; then
    rm -f "$sourceloc"
  fi
done

